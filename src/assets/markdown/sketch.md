### 1.1 课题背景与来源

&ensp;&ensp;&ensp;&ensp;网络协议的不断更新变换，使得网络结构日趋复杂，演变出许多新型的未知协议，大大地增加网络流量管理和识别的难度。因此，亟需对网络流量的行为特征进行深入分析，从而实现有效管理监控，为网络用户提供一个安全可靠的网络环境。

&ensp;&ensp;&ensp;&ensp;网络协议识别技术是指从海量的网络流数据中，准确有效地识别出不同流量的协议类型，进而更好地掌握网络行为特征，实现对数据流量进行差别化的管理控制。在网络安全监控领域，网络协议识别技术不仅可以有效的阻止网络攻击和检测木马病毒，还能够对那些新型未知网络协议的行为特征进行识别，极大丰富网络安全监控的手段，实现网络安全的高效运行。因此，准确有效地识别各类网络协议数据对于提高网络服务质量、营造网络安全环境、保证网络健康运行等具有重要意义。

### 1.2 传统的协议识别技术

&ensp;&ensp;&ensp;&ensp;传统的网络协议识别技术可以大致分为以下三类:基于端口的识别、基于载荷内容的识别（或称为深度包检测， DPI）、基于网络流量行为的识别（或称为深度流检测，DFI）

#### 1.2.1 基于端口的识别

&ensp;&ensp;&ensp;&ensp;传统的基于端口的识别技术指是通过识别网络流量包包头所携带的端口号或五元组（源IP、目的IP、源端口、目的端口、传输层协议类型），随后找出此端口号所在范围对应的网络应用，匹配后即完成流量识别与分类。

&ensp;&ensp;&ensp;&ensp;这种流量识别的方法优点是简单易操作，容易实现，只用简单的规则就可以完成，在当时的网络环境中识别效率和准确率都很高。

&ensp;&ensp;&ensp;&ensp;但是随着网络技术的发展，网络应用协议在技术和应用层面出现了巨大的变化:以P2P为首的绝大多数网络协议通常采用随机化端口、端口号伪装或端口号复用等技术进行数据传输;用户自身可根据需要对应用层端口进行隐藏或伪造;大量未在互联网数字分配机构（IANA）中注册的私有协议使用其未知的端口号......这些变化大大地降低了该方法识别的准确性。此外，那些加密协议或未知协议端口号的获取十分困难，使得这一方法在实现上遇到了很大阻碍。

&ensp;&ensp;&ensp;&ensp;基于端口的流量识别方法由于其局限性，目前已经不适应用于细粒度的流量识别了，现在一般用于检测粗粒度的高带宽网络设备流量的均衡性

#### 1.2.2 基于载荷内容的识别（DPI）

&ensp;&ensp;&ensp;&ensp;传统的基于载荷内容的识别（深度包检测，DPI）是指，首先检测IP包头和TCP/IP包头，除此之外还会检测分析数据包内的所有载荷内容，结合两种指标来对流量进行识别。实际的工作中，首先分析目标流量的协议或者应用特征，分析其发送的数据包载荷中所包含的特征码。在得到应用或协议的特征码后，根据特征码对数据包进行过滤筛选。

&ensp;&ensp;&ensp;&ensp;该识别方法可有效地减少动态端口的影响，能够避免伪造和隐藏，具有较高的协议识别的准确性与健壮性。

&ensp;&ensp;&ensp;&ensp;但同时，由于该方法的实现是建立在一个可靠有效的载荷特征库基础上，随着新、旧网络协议的不断涌现、不断更新，载荷特征库的存储量也在迅速膨胀，更新的工作消耗巨大的系统资源和存储开销，使得其在高速的主干网络中应用受到了限制;另外，对于那些加密协议或未知协议，由于该方法无法获取数据包的负载明文和语法特征导致其失去了识别能力;同时，随着技术发展，对于数据包的传输有了加密技术的应用，导致该方法无法获取数据内容，无法得到数字特征，也就无法进行相应的识别。因此，传统的基于载荷内容的识别方法受到了很大的局限。

#### 12.3 基于网络流量行为的识别（DFI）

&ensp;&ensp;&ensp;&ensp;传统的基于网络流量行为的识别（深度流检测，DFI）是指，通过网络通信过程中产生的流的统计特征来识别特定的流量，配合机器学习方法来进行，基于网络流量的识别方法将网络流量的识别问题转化成为了机器学习的分类问题。通过学习网络流在传输过程中表现出的统计特征（如包长度、平均包的间隔时间、流的持续时间等）来识别协议类型。该方法可以有效地避免动态端口、网络地址转换的跋响，不需要分析载荷内容，展现出对未知协议和加密协议的识别能力，有着较强的灵活性和适用性。

&ensp;&ensp;&ensp;&ensp;但是，该方法在获得数据流及其相应统计信息具有一定难度，对于数据流的甄别往往会成为分析效率的瓶颈;同时。该方法的系统时空开销较大，识别性能易受网络环境变化和应用程序升级的影响，导致其识别的实时性较差。

### 1.3 课题概述

&ensp;&ensp;&ensp;&ensp;为了解决传统基于载荷内容的识别技术（DPI）的局限性，我们引入了机器学习方法来提高其识别效率和应用范围，也就是我们现在的课题——基于机器学习方法的深度包检测技术（Deep Packet Inspection Based on Machine Learning, DPIBML）。该算法旨在通过迅速发展的人工智能思想和算法来对传统的协议识别方法进行改进和提升，使得分析的效率和准确率得到明显的提升。

&ensp;&ensp;&ensp;&ensp;该算法在传统的深度包检测技术基础上，增加了包括使用卷积神经网络
（Convolutional Neural Networks, CNN）进行的已知协议分类器和使用 K 均值（K-
Means）进行的未知协议聚类器。通过监督学习和无监督学习的搭配使用，更好地适应了当前复杂多变的网络环境和层出不穷的协议类型，使得算法整体分辨率有了显著的提升。

&ensp;&ensp;&ensp;&ensp;同样的，得益于机器学习模型的可重用性，一旦该模型进行了充分的前期训练，实际使用时将可以直接将相应参数代入已有模型进行分析，效率极高。这一特性极大地提升了算法在生产环境中的识别速度，减少了因为算法执行时间过长而导致的性能瓶颈，更有利于在高速网络中进行部署和应用。

&ensp;&ensp;&ensp;&ensp;随着人工智能在 FPGA 领域的应用越来越多，今后还可以将该算法部署到各类嵌入式平台、 IoT 设备中以及实现智能路由、智能网关、智能防火墙等实际物联网应用。
